<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <!-- Technical Support Request Views -->

	<!-- Technical Support Request - Tree View -->
    <record id="technical_support_request_tree_view" model="ir.ui.view">
    	<field name="name">TSR Tree View</field>
      <field name="model">technical_support.request</field>
      <field name="arch" type="xml">
      	<tree string="TSR">
          <field name="name"/>
					<field name="requested_date"/>
					<field name="client_id"/>
          <field name="equipment_id"/>
					<field name="user_id"/>
        	<field name="subject"/>
          <field name="state"/>
        </tree>
      </field>
    </record>

	<!-- Technical Support Request - Calendar View -->
    <record id="technical_support_request_calendar_view" model="ir.ui.view">
      <field name="name">TSR - Calendar View</field>
      <field name="model">technical_support.request</field>
      <field name="arch" type="xml">
        <calendar color="user_id" date_start="requested_date" date_delay="duration" string="Technical Support Requests">
          <field name="name"/>
					<field name="client_id"/>
					<field name="equipment_id"/>
					<field name="user_id"/>
          <field name="subject"/>
        </calendar>
      </field>
    </record>

	<!-- Technical Support Request - Form View -->
    <record id="technical_support_request_form_view" model="ir.ui.view">
    	<field name="name">technical_support.request.form</field>
    	<field name="model">technical_support.request</field>
      <field name="arch" type="xml">
      	<form string="TSR">
        	<header>
						<button name="%(action_pending_client)d" states="draft" string="Pending by the Customer" class="oe_highlight" type="action" groups="technical_support.group_technical_support_engineer"/>
						<button name="%(action_order_assign)d" states="draft,waiting_for_customer,run,done" string="New Order" type="action" class="oe_highlight" groups="technical_support.group_technical_support_engineer"/>
            <button name="%(action_request_reject)d" states="draft" string="Reject Request" type="action" groups="technical_support.group_technical_support_engineer"/>
						<button name="action_cancel" states="draft" string="Cancel" type="object"/>
						<button name="action_draft" states="assigned" string="Draft" type="object" groups="technical_support.group_technical_support_engineer"/>
            <field name="state" widget="statusbar" statusbar_visible="draft,scheduled,run,done,awaiting_report,completed"/>
          </header>
          <sheet>
						<div class="oe_button_box" name="button_box">
							<button class="oe_stat_button" name="action_view_report" type="object" icon="fa-file-pdf-o">
	            	<field string="TSO" name="technical_support_count" widget="statinfo"/>
	          	</button>
						</div>
            <div class="oe_title">
              <h1># <field name="name" readonly="1"/></h1>
              <h5><field name="subject" placeholder="Subject ..."/></h5>
            </div>
            <group>
              <group name="request" string="Request Detail">
                <field name="maintenance_type" string="Type of Request"/>
								<field name="client_id"/>
                <field name="equipment_id" domain="[('client_id','=',client_id)]"/>
								<field name="user_id"/>
              </group>
              <group name="date" string="Dates Information">
                <field name="requested_date"/>
                <field name="schedule_date"/>
                <field name="date_planned"/>
								<field name="execution_date"/>
							</group>
            </group>
            <group name="more_description" string="DescripciÃ³n">
              <field name="description" placeholder="write more detail of the request ..." colspan="4" nolabel="1"/>
            </group>
						<notebook>
							<page name="detail" string="More Details">
                <group>
									<group name="equipment_information" string="Equipment Information">
                    <field name="equipment_number"/>
                    <field name="brand_id" widget="manyone"/>
                    <field name="model_id" widget="manyone"/>
										<field name="modality_id" widget="manyone"/>
										<field name="parent_id" widget="manyone"/>
										<field name="zone_id" widget="manyone"/>
									</group>
									<group name="subscription_information" string="Subscription Information">

									</group>
								</group>
								<group>
									<field name="detail_new_order" colspan="4" nolabel="1"/>
								</group>
								<group string="Reject Reason" states="reject">
			            <field name="reject_reason" colspan="4" nolabel="1"/>
			          </group>
							</page>
              <page name="preventive" string="Preventive" attrs="{'invisible':[('maintenance_type', '!=', 'pm')]}">
                <group>
                  <group name="preventive_date" string="Preventive Date">
                    <field name="request_date"/>
                    <field name="close_date"/>
                  </group>
                  <group name="preventive_duration" string="Preventive Duration">
                    <label for="duration"/>
                    <div><field name="duration" widget="float_time" class="oe_inline"/> <span class="ml8">hours</span></div>
                  </group>
                </group>
              </page>
              <page name="predictive" string="Predictive" attrs="{'invisible':[('maintenance_type', '!=', 'pd')]}">
                <group>
                  <group name="" string="">

                  </group>
                  <group name="" string="">

                  </group>
                </group>
              </page>
              <page name="install" string="Install" attrs="{'invisible':[('maintenance_type', '!=', 'in')]}">
                <group>
                  <group name="" string="">

                  </group>
                  <group name="" string="">

                  </group>
                </group>
              </page>
              <page name="Uninstall" string="Uninstall" attrs="{'invisible':[('maintenance_type', '!=', 'un')]}">
                <group>
                  <group name="" string="">

                  </group>
                  <group name="" string="">

                  </group>
                </group>
              </page>
              <page name="fco" string="FCO" attrs="{'invisible':[('maintenance_type', '!=', 'fco')]}">
                <group>
                  <group name="" string="">

                  </group>
                  <group name="" string="">

                  </group>
                </group>
              </page>
						</notebook>
          </sheet>
					<div class="oe_chatter">
							<field name="message_follower_ids" widget="mail_followers"/>
							<field name="activity_ids" widget="mail_activity"/>
							<field name="message_ids" widget="mail_thread"/>
					</div>
        </form>
      </field>
		</record>

  <!-- Technical Support Request - Search View -->
    <record id="technical_support_request_search" model="ir.ui.view">
      <field name="name">Technical Support Request - Search</field>
      <field name="model">technical_support.request</field>
      <field name="arch" type="xml">
        <search string="Search Technical Support Request">
          <field name="state"/>
          <field name="name"/>
					<field name="client_id"/>
          <field name="equipment_id"/>
          <filter icon="terp-mail-message-new" string="Unread Messages" name="message_unread" domain="[('message_unread','=',True)]"/>
          <filter string="My TSR" domain="[('user_id','=',uid)]" name="my_tsr"/>
          <separator/>
            <filter string="My Activities" name="activities_my" domain="[('activity_ids.user_id', '=', uid)]"/>
          <separator/>
            <filter string="Late Activities" name="activities_overdue" domain="[('activity_ids.date_deadline', '&lt;', context_today().strftime('%Y-%m-%d'))]" help="Show all records which has next action date is before today"/>
            <filter string="Today Activities" name="activities_today" domain="[('activity_ids.date_deadline', '=', context_today().strftime('%Y-%m-%d'))]"/>
            <filter string="Future Activities" name="activities_upcoming_all" domain="[('activity_ids.date_deadline', '&gt;', context_today().strftime('%Y-%m-%d'))]"/>
          <separator/>
          <filter icon="terp-document-new" name="open" string="Open" domain="['|',('state','in',('draft', 'waiting_for_part', 'waiting_for_customer', 'scheduled', 'run', 'done', 'awaiting_report')),('message_unread','=',True)]" help="Request"/>
          <group expand="0" string="Group By">
            <filter name="group_state" string="State" context="{'group_by': 'state'}"/>
            <filter name="group_type" string="Request Type" context="{'group_by': 'maintenance_type'}"/>
            <filter name="group_equipment" string="Equipment" context="{'group_by': 'equipment_id'}"/>
            <filter name="group_client" string="Client" context="{'group_by': 'client_id'}"/>
            <filter name="group_user" string="Responsible" context="{'group_by': 'user_id'}"/>
          </group>
        </search>
      </field>
    </record>

  <!-- Technical Support Request - Action -->
    <record id="action_requests" model="ir.actions.act_window">
            <field name="name">Technical Support Requests</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">technical_support.request</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,calendar</field>
            <field name="context">{'search_default_open': 1}</field>
        </record>

</odoo>
